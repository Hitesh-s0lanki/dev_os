#include "font.h"
#include "graphics.h"    // for draw_pixel()
#include "string/string.h"      // for strlen()

// Paste the contents of font8x8_basic here (128Ã—8 bytes).
// For brevity, include just a few example glyphs:
const uint8_t font8x8_basic[128][8] = {
    // ASCII 32 ' ' (space)
    [32] = { 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
    // ASCII 46 '.'
    [46] = { 0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x00 },
    // ASCII 48 '0'
    [48] = { 0x3C,0x66,0x6E,0x7E,0x76,0x66,0x3C,0x00 },
    // ASCII 65 'A'
    [65] = { 0x18,0x3C,0x66,0x7E,0x66,0x66,0x66,0x00 },
    // ASCII 68 'D'
    [68] = { 0x7C,0x66,0x66,0x66,0x66,0x66,0x7C,0x00 },
    // ASCII 71 'G'
    [71] = { 0x3C,0x66,0x60,0x6E,0x66,0x66,0x3C,0x00 },
    // ASCII 73 'I'
    [73] = { 0x3C,0x18,0x18,0x18,0x18,0x18,0x3C,0x00 },
    // ASCII 76 'L'
    [76] = { 0x60,0x60,0x60,0x60,0x60,0x60,0x7E,0x00 },
    // ASCII 78 'N'
    [78] = { 0x66,0x76,0x7E,0x6E,0x66,0x66,0x66,0x00 },
    // ASCII 79 'O'
    [79] = { 0x3C,0x66,0x66,0x66,0x66,0x66,0x3C,0x00 },
    // ASCII 82 'R'
    [82] = { 0x7C,0x66,0x66,0x7C,0x6C,0x66,0x67,0x00 },
    // ASCII 83 'S'
    [83] = { 0x3C,0x66,0x60,0x3C,0x06,0x66,0x3C,0x00 },
    // ASCII 84 'T'
    [84] = { 0x7E,0x5A,0x18,0x18,0x18,0x18,0x3C,0x00 },
    // ASCII 100 'd'
    [100]= { 0x06,0x06,0x3E,0x66,0x66,0x66,0x3E,0x00 },
    // ASCII 103 'g'
    [103]= { 0x00,0x00,0x3E,0x66,0x66,0x3E,0x06,0x3C },
    // Add the rest of the 128 glyphs...
};

void draw_char(int x, int y, char c, uint32_t fg, uint32_t bg) {
    if ((uint8_t)c >= 128) return;
    const uint8_t *glyph = font8x8_basic[(uint8_t)c];
    for (int row = 0; row < 8; row++) {
        uint8_t bits = glyph[row];
        for (int col = 0; col < 8; col++) {
            uint32_t color = (bits & (1 << col)) ? fg : bg;
            draw_pixel(x + col, y + row, color);
        }
    }
}

void draw_text(int x, int y, const char *str, uint32_t fg, uint32_t bg) {
    int len = strlen(str);
    for (int i = 0; i < len; i++) {
        draw_char(x + i*8, y, str[i], fg, bg);
    }
}
